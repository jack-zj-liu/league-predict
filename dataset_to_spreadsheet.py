from riotwatcher import LolWatcher, ApiError
import pandas as pd
import xlsxwriter as xw
import json
from tqdm import tqdm

# globals 
api_key = 'RGAPI-d517c64a-10f4-42cc-94d9-e1e3cb225ee6'
watcher = LolWatcher(api_key)
my_region = "na1"

training = xw.Workbook('trainingnew.xlsx')
trainsheet = training.add_worksheet()

content = ["win", "baw", "bal", "bbw", "bbl", "bcw", "bcl", "bdw", "bdl", "bew", "bel", 
                  "paw", "pal", "pbw", "pbl", "pcw", "pcl", "pdw", "pdl", "pew", "pel", "new"]

row = 0
col = 0

for item in content:
    trainsheet.write(row, col, item)
    col += 1

col = 0
row += 1

game_ids = [3562935395, 3562935400, 3562935481, 3562935486, 3562935528, 3562935568, 3562935579, 3562935582, 3562935594, 3562935621, 3562935622, 3562935624, 3562935629, 3562935630, 3562935636, 3562935644, 3562935669, 3562935676, 3562935686, 3562935695, 3562935715, 3562935721, 3562935733, 3562935737, 3562935762, 3562935771, 3562935773, 3562935779, 3562935780, 3562935788, 3562935811, 3562935831, 3562935832, 3562935850, 3562935909, 3562935910, 3562935912, 3562935918, 3562935932, 3562935934, 3562935936, 3562935941, 3562935949, 3562935959, 3562935966, 3562935969, 3562935975, 3562935982, 3562935989, 3562936005, 3562936020, 3562936030, 3562936038, 3562936046, 3562936056, 3562936058, 3562936076, 3562936107, 3562936111, 3562936112, 3562936153, 3562936159, 3562936165, 3562936174, 3562936180, 3562936209, 3562936210, 3562936222, 3562936237, 3562936251, 3562936260, 3562936264, 3562936286, 3562936287, 3562936309, 3562936314, 3562936315, 3562936325, 3562936328, 3562936340, 3562936354, 3562936356, 3562936376, 3562936377, 3562936378, 3562936383, 3562936389, 3562936393, 3562936397, 3562936421, 3562936458, 3562936460, 3562936465, 3562936481, 3562936486, 3562936489, 3562936495, 3562936502, 3562936511, 3562936512, 3562936530, 3562936533, 3562936542, 3562936543, 3562936548, 3562936554, 3562936555, 3562936582, 3562936585, 3562936599, 3562936606, 3562936607, 3562936624, 3562936632, 3562936649, 3562936653, 3562936677, 3562936691, 3562936692, 3562936701, 3562936705, 3562936707, 3562936713, 3562936723, 3562936724, 3562936725, 3562936768, 3562936770, 3562936781, 3562936787, 3562936788, 3562936825, 3562936845, 3562936865, 3562936871, 3562936889, 3562936899, 3562936900, 3562936904, 3562936930, 3562936935, 3562936938, 3562936950, 3562936965, 3562936991, 3562937005, 3562937010, 3562937018, 3562937054, 3562937076, 3562937109, 3562937122, 3562937128, 3562937130, 3562937153, 3562937161, 3562937169, 3562937182, 3562937183, 3562937212, 3562937222, 3562937259, 3562937275, 3562937312, 3562937313, 3562937319, 3562937330, 3562937340, 3562937346, 3562937347, 3562937353, 3562937354, 3562937358, 3562937366, 3562937372, 3562937384, 3562937395, 3562937413, 3562937437, 3562937439, 3562937446, 3562937459, 3562937467, 3562937477, 3562937488, 3562937489, 3562937500, 3562937519, 3562937523, 3562937527, 3562937536, 3562937542, 3562937551, 3562937558, 3562937576, 3562937584, 3562937586, 3562937588, 3562937592, 3562937606, 3562937607, 3562937611, 3562937618, 3562937629, 3562937636, 3562937639, 3562937644, 3562937673, 3562937674, 3562937675, 3562937682, 3562937687, 3562937707, 3562937712, 3562937713, 3562937714, 3562937715, 3562937723, 3562937762, 3562937764, 3562937777, 3562937805, 3562937832, 3562937838, 3562937844, 3562937855, 3562937856, 3562937877, 3562937883, 3562937884, 3562937921, 3562937922, 3562937929, 3562937939, 3562937940, 3562937945, 3562937946, 3562937948, 3562937955, 3562937961, 3562937964, 3562937967, 3562937970, 3562937976, 3562937981, 3562937985, 3562937987, 3562937992, 3562938010, 3562938019, 3562938023, 3562938035, 3562938038, 3562938042, 3562938046, 3562938047, 3562938057, 3562938070, 3562938081, 3562938091, 3562938101, 3562938102, 3562938104, 3562938105, 3562938106, 3562938107, 3562938114, 3562938125, 3562938137, 3562938139, 3562938143, 3562938148, 3562938163, 3562938167, 3562938174, 3562938193, 3562938198, 3562938210, 3562938233, 3562938238, 3562938239, 3562938262, 3562938274, 3562938294, 3562938295, 3562938296, 3562938305, 3562938309, 3562938322, 3562938328, 3562938329, 3562938331, 3562938338, 3562938344, 3562938352, 3562938353, 3562938371, 3562938402, 3562938408, 3562938432]
for ranked_id in tqdm(game_ids):
    current_game = watcher.match.by_id(my_region, ranked_id)
    col = 0
    if current_game['teams'][0]['win'] == "Win":
        trainsheet.write(row, col, 0) # writes who wins here
    else :
        trainsheet.write(row, col, 1)
    col += 1
    for player in current_game['participantIdentities']:
        # print(player['player']['summonerName'])
        curr_id = player['player']['summonerId']
        curr_ranked = watcher.league.by_summoner(my_region, curr_id)

        # print(curr_ranked)
        if curr_ranked and (len(curr_ranked) == 2):
            if curr_ranked[0] and curr_ranked[0]['queueType'] == "RANKED_SOLO_5x5":
                solo = curr_ranked[0]
            elif curr_ranked[1] and curr_ranked[1]['queueType'] == "RANKED_SOLO_5x5":
                solo = curr_ranked[1]
            else:
                solo = None
        elif curr_ranked and (len(curr_ranked) == 1):
            solo = curr_ranked[0]
        else:
            solo = None
        # print(solo)
        
        if solo: # writes wins and losses here
            trainsheet.write(row, col, solo['wins'])
            col += 1
            trainsheet.write(row, col, solo['losses'])        
            col += 1    
        else:
            trainsheet.write(row, col, 0)
            col += 1
            trainsheet.write(row, col, 0)        
            col += 1
            # print("NO SOLO QUEUE GAMES PLAYED")
    row += 1
    # print("team 1 win: " + str(current_game['teams'][0]['win'] == "Win"))

training.close()

